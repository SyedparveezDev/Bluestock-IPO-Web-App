{% extends 'ipo_app/base.html' %}
{% load static %}

{% block content %}
<h3 class="mb-3">Upcoming IPO</h3>
<p class="text-muted">Companies that have filed for an IPO with SEBI. Few details might be disclosed by the companies later.</p>

<div class="row">
  {% for ipo in ipos %}
  <div class="col-md-4">
    <div class="ipo-card">
      <a href="?ipo_id={{ ipo.id }}" class="text-decoration-none">
        <img src="{{ ipo.logo.url }}" alt="{{ ipo.company_name }}" class="mb-2" style="height:40px;">
        <h5 class="mb-2">{{ ipo.company_name }}</h5>
      </a>
      <ul class="list-unstyled small">
        <li>Price Band: {{ ipo.price_band|default:"Not issued" }}</li>
        <li>Open: {{ ipo.open_date|default:"Not issued" }}</li>
        <li>Close: {{ ipo.close_date|default:"Not issued" }}</li>
        <li>Issue Size: {{ ipo.issue_size|default:"Not issued" }}</li>
        <li>Issue Type: {{ ipo.issue_type|default:"Not issued" }}</li>
        <li>Listing Date: {{ ipo.listing_date|default:"Not issued" }}</li>
      </ul>
      <div class="d-flex gap-2">
        {% if ipo.rhp_pdf %}
        <a href="{{ ipo.rhp_pdf.url }}" class="btn btn-sm btn-rhp">RHP</a>
        {% endif %}
        {% if ipo.drhp_pdf %}
        <a href="{{ ipo.drhp_pdf.url }}" class="btn btn-sm btn-drhp">DRHP</a>
        {% endif %}
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<hr class="my-4">

<h4>IPO Detail</h4>
{% if selected_ipo %}
<div class="card mb-3">
  <div class="row g-0">
    <div class="col-md-2">
      <img src="{{ selected_ipo.logo.url }}" class="img-fluid rounded-start" alt="{{ selected_ipo.company_name }}">
    </div>
    <div class="col-md-10">
      <div class="card-body">
        <h5 class="card-title">{{ selected_ipo.company_name }}</h5>
        <p class="card-text">
          Price Band: {{ selected_ipo.price_band|default:"Not issued" }}<br>
          Open Date: {{ selected_ipo.open_date|default:"Not issued" }}<br>
          Close Date: {{ selected_ipo.close_date|default:"Not issued" }}<br>
          Issue Size: {{ selected_ipo.issue_size|default:"Not issued" }}<br>
          Listing Date: {{ selected_ipo.listing_date|default:"Not issued" }}<br>
          IPO Price: {{ selected_ipo.ipo_price|default:"Not issued" }}<br>
          Listing Price: {{ selected_ipo.listing_price|default:"Not issued" }}<br>
          Current Market Price: {{ selected_ipo.current_market_price|default:"Not issued" }}<br>
          Current Return: {{ selected_ipo.current_return|default:"Not issued" }}
        </p>
        <div class="d-flex gap-2">
          {% if selected_ipo.rhp_pdf %}
          <a href="{{ selected_ipo.rhp_pdf.url }}" class="btn btn-sm btn-rhp">Download RHP</a>
          {% endif %}
          {% if selected_ipo.drhp_pdf %}
          <a href="{{ selected_ipo.drhp_pdf.url }}" class="btn btn-sm btn-drhp">Download DRHP</a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% else %}
<p class="text-muted">Select an IPO to see details.</p>
{% endif %}
{% endblock %}
