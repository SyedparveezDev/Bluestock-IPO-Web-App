{% extends 'base.html' %}
{% block content %}

<h2 class="mb-4">IPO List</h2>

<!-- Search & Filter -->
<form method="get" class="row g-2 mb-4">
  <div class="col-md-4">
    <input type="text" name="q" placeholder="Search IPO by name"
           value="{{ query|default:'' }}" class="form-control">
  </div>
  <div class="col-md-4">
    <select name="status" class="form-select">
      <option value="">All Status</option>
      <option value="upcoming" {% if status_filter == 'upcoming' %}selected{% endif %}>Upcoming</option>
      <option value="ongoing" {% if status_filter == 'ongoing' %}selected{% endif %}>Ongoing</option>
      <option value="listed" {% if status_filter == 'listed' %}selected{% endif %}>Listed</option>
    </select>
  </div>
  <div class="col-md-4">
    <button type="submit" class="btn btn-primary">Search</button>
  </div>
</form>

<!-- IPO Cards -->
<div class="row">
  {% for ipo in ipos %}
  <div class="col-md-4 mb-4">
    <div class="card h-100">
      {% if ipo.logo %}
        <img src="{{ ipo.logo.url }}" class="card-img-top" alt="{{ ipo.company_name }}">
      {% endif %}
      <div class="card-body">
        <h5 class="card-title">{{ ipo.company_name }}</h5>
        <p class="card-text">
          <strong>Price Band:</strong> {{ ipo.price_band }}<br>
          <strong>Status:</strong> {{ ipo.status|title }}<br>
          <strong>Open:</strong> {{ ipo.open_date }}<br>
          <strong>Close:</strong> {{ ipo.close_date }}
        </p>
        <a href="{% url 'ipo-detail' ipo.pk %}" class="btn btn-primary btn-sm">View Details</a>
      </div>
    </div>
  </div>
  {% empty %}
  <p>No IPOs found.</p>
  {% endfor %}
</div>

{% endblock %}
